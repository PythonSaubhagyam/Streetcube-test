
{% extends 'streetcube/base.jinja2' %}
{% block title %}{% endblock %}
{% block content %} 

 <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
 
 <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/jquery.validate.min.js"></script>

<style>
  
       
            .form-group  input {
                display: block;
                width: 100%;
                height: calc(2.25rem + 2px);
                padding: .375rem .75rem;
                font-size: 1rem;
                font-weight: 400;
                line-height: 1.5;
                color: #ffffff;
                background-color: rgb(255 255 255 / 0%);
                background-clip: padding-box;
                border: 2px solid #ced4da;
                border-radius: 0;
                transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
                outline:0;
            }
          
            .form-control:focus{
                outline:0;
                background:none;
                border-color:white;
                box-shadow:none;
            }
            .form-control::placeholder {
              color: rgb(255 255 255 / 64%);
              opacity: 1; /* Firefox */
            }
            
            .form-control:-ms-input-placeholder { /* Internet Explorer 10-11 */
             color: rgb(255 255 255 / 64%);
            }
            
            .form-control::-ms-input-placeholder { /* Microsoft Edge */
             color: rgb(255 255 255 / 64%);
            }
            .btn{
                background: #fff;
                border-radius: 0;
            }
            .box_menu {
                padding: 3rem 3rem 3rem 3rem;
            }
    </style>

<div class="p-5 logo_area">
                <img width="120" src="/static/img/logo.png">
            </div>
<div class="mt-3 box_menu">
				<div class="row m-0">
					<div class="col-md-3">
						
					</div>
					<div class="col-md-6">
						<form  action="" method="POST" name="regotp">

                          <h4 class="text-center">Enter your 4-Digit PIN</h4>
                            <div class="form-group mt-3">
                            <input placeholder="4-Digit PIN" class="form-control" oninput="this.className = ''" name="otp" id="otp">
                            </div>

                            <div>
                                <label class="mt-4"><a href="/resend/otp" style="text-decoration:none; color:#dc3545; display:block; display:none; padding-top:10px;" id="rsend">Resend 4-Digit PIN</a></label>
                                <span id="timer"></span>
                             </div>
                                                   
                            <div class="text-right">
                              <button type="submit" class="btn">Confirm</button>
                            </div> 
                         
                         
                          
                        </form>

					</div>
					<div class="col-md-3">
						
					</div>
				</div>
			</div>

 
 
  

{% block javascript %}

<script>
$("#otp").focus();

$("#otp").keydown(function(event) {
            // Allow only backspace and delete
            if ( event.keyCode == 46 || event.keyCode == 8 ) {
                // let it happen, don't do anything
            }
            else {
                // Ensure that it is a number and stop the keypress
                if (event.keyCode < 48 || event.keyCode > 57 ) {
                    event.preventDefault(); 
                }   
            }
    });

$(function() {

  $("form[name='regotp']").validate({
    
    rules: {
     
      otp: {
            required:true,
            minlength:4,
            maxlength:4,
            digits:true
        },
    },
    
    messages: {
       otp:{
            required:   "Otp is requied",
            minlength:  "Otp should be minimum 4 digits",
            maxlength:  "Otp should be minimum 4 digits",
            digits:     "Only numbers are allowed in this field"
        },
    },
   
    submitHandler: function(form) {
      form.submit();
    }
  });
});

/*
$(document).on('submit', 'form', function() {
    // Here you get the values:
    var otp = $('#otp').val();
   
    // OR
    // you have a simpler option:
    // var data = this.serialize();

    $.ajax({
      type: 'POST',
      data: {
        otp: otp,
      },
      // OR
      // data: data, // if you use the form serialization above
      url: "/otp-msg",
      success: added,
      error: showError
    });
  });
*/
</script> 



<script>

let timerOn = true;

function timer(remaining) {
  var x = document.getElementById("rsend");
  var m = Math.floor(remaining / 60);
  var s = remaining % 60;

  m = m < 10 ? '0' + m : m;
  s = s < 10 ? '0' + s : s;
  document.getElementById('timer').innerHTML = m + ':' + s;
  remaining -= 1;

  if(remaining >= 0 && timerOn) {
    setTimeout(function() {
        timer(remaining);
    }, 1000);
    return;
  }

  if(!timerOn) {
    // Do validate stuff here
    return;
  }
  x.style.display = "block";
  $('#timer').html('');
  // Do timeout stuff here
  //alert('Timeout for otp');

}

timer(60);
</script>  

      
{% endblock %}


 {% endblock %} 